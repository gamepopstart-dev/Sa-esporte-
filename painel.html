<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SA ESPORTE</title>

<style>

body{
margin:0;
font-family:Arial;
background:#0b1220;
color:white;
}

.topo{
background:#1f3a8a;
padding:15px;
display:flex;
justify-content:space-between;
align-items:center;
}

.logo{
font-size:20px;
font-weight:bold;
}

.menu button{
background:#22c55e;
border:none;
color:white;
padding:8px 12px;
margin-left:5px;
cursor:pointer;
}

.saldo{
color:#22c55e;
font-weight:bold;
margin-left:10px;
}

.container{
padding:10px;
margin-bottom:120px;
}

.liga{
background:#1e293b;
padding:8px;
margin-top:10px;
font-weight:bold;
}

.jogo{
background:#0f172a;
padding:10px;
border-bottom:1px solid #1e293b;
}

.times{
margin-bottom:8px;
}

.odds{
display:flex;
gap:5px;
}

.odd{
flex:1;
background:#facc15;
color:black;
padding:10px;
text-align:center;
cursor:pointer;
font-weight:bold;
border-radius:5px;
}

.odd:hover{
background:#fde047;
}

.bilhete{
position:fixed;
bottom:0;
width:100%;
background:#020617;
padding:10px;
border-top:2px solid #1e293b;
}

input{
padding:5px;
width:80px;
}

button.apostar{
background:#22c55e;
border:none;
padding:10px;
color:white;
margin-left:5px;
cursor:pointer;
}

</style>

</head>
<body>

<div class="topo">

<div class="logo">
SA ESPORTE
</div>

<div>

<span id="nomeUsuario"></span>

<span class="saldo">
Saldo: R$ <span id="saldo"></span>
</span>

</div>

<div class="menu">

<button onclick="location.href='historico.html'">
Histórico
</button>

<button onclick="logout()">
Sair
</button>

</div>

</div>

<div class="container">

<div class="liga">Jogos do Dia</div>

<div id="jogos">
Carregando jogos...
</div>

</div>

<div class="bilhete">

Bilhete:

<div id="listaBilhete"></div>

Valor: R$
<input id="valor" type="number" value="10">

<button class="apostar" onclick="finalizar()">
Finalizar
</button>

</div>

<script>

// proteção login
if(localStorage.getItem("logado")!="sim"){

location.href="login.html";

}

// carregar usuário
var usuario = JSON.parse(localStorage.getItem("usuario"));

if(!usuario){

usuario = {

nome:"Usuário",
saldo:1000

};

localStorage.setItem("usuario", JSON.stringify(usuario));

}

// mostrar nome
document.getElementById("nomeUsuario").innerText =
usuario.nome;

// mostrar saldo
function atualizarSaldo(){

var user = JSON.parse(localStorage.getItem("usuario"));

document.getElementById("saldo").innerText =
user.saldo.toFixed(2);

}

atualizarSaldo();

var bilhete=[];


// carregar jogos reais
function carregar(){

fetch("https://www.thesportsdb.com/api/v1/json/3/eventsnextleague.php?id=4328")

.then(r=>r.json())

.then(data=>{

var html="";

data.events.forEach(jogo=>{

var casa=jogo.strHomeTeam;
var fora=jogo.strAwayTeam;

var odd1=(Math.random()*3+1).toFixed(2);
var oddx=(Math.random()*3+1).toFixed(2);
var odd2=(Math.random()*3+1).toFixed(2);

html+=`

<div class="jogo">

<div class="times">
${casa} vs ${fora}
</div>

<div class="odds">

<div class="odd"
onclick="add('${casa}','${fora}','Casa',${odd1})">
${odd1}
</div>

<div class="odd"
onclick="add('${casa}','${fora}','Empate',${oddx})">
${oddx}
</div>

<div class="odd"
onclick="add('${casa}','${fora}','Fora',${odd2})">
${odd2}
</div>

</div>

</div>

`;

});

document.getElementById("jogos").innerHTML=html;

});

}


// adicionar aposta
function add(casa,fora,tipo,odd){

bilhete.push({

casa:casa,
fora:fora,
tipo:tipo,
odd:parseFloat(odd)

});

mostrar();

}


// mostrar bilhete
function mostrar(){

var html="";

bilhete.forEach(b=>{

html+=`
${b.casa} vs ${b.fora}
(${b.tipo}) @ ${b.odd}
<br>
`;

});

document.getElementById("listaBilhete").innerHTML=html;

}


// finalizar aposta
function finalizar(){

if(bilhete.length==0){

alert("Selecione apostas");
return;

}

var valor=parseFloat(document.getElementById("valor").value);

var user=JSON.parse(localStorage.getItem("usuario"));

if(valor > user.saldo){

alert("Saldo insuficiente");
return;

}

var total=1;

bilhete.forEach(b=>{

total*=b.odd;

});

var retorno=(valor*total).toFixed(2);

// descontar saldo
user.saldo -= valor;

localStorage.setItem("usuario", JSON.stringify(user));

// salvar aposta
var apostas =
JSON.parse(localStorage.getItem("apostas") || "[]");

apostas.push({

usuario:user.nome,
bilhete:bilhete,
valor:valor,
retorno:retorno,
data:new Date().toLocaleString(),
status:"pendente"

});

localStorage.setItem("apostas",
JSON.stringify(apostas));

alert("Aposta realizada com sucesso");

bilhete=[];

mostrar();

atualizarSaldo();

}


// logout
function logout(){

localStorage.removeItem("logado");

location.href="login.html";

}


// iniciar
carregar();

</script>

</body>
</html>
